#loc = loc(unknown)
#loc1 = loc("y.1")
module @MM_0 attributes {module.FLOPs = 34816 : i64, module.addr_mode = "basic", module.asymmetric = false, module.chip = "bm1690", module.cores = 8 : i64, module.devices = 1 : i64, module.high_precision = false, module.inputs = ["y.1"], module.mode = "F16", module.outputs = ["4_f32"], module.platform = "TORCH", module.q_group_size = 0 : i64, module.q_symmetric = false, module.state = "TPU_ADDRESSED", module.top_run_mode = "STATIC", module.weight_file = "mm_0_tpu_addressed_bm1690_f16_weight.npz"} {
  module @MM_0 attributes {module.coeff_addr = 1099511627776 : i64, module.coeff_size = 4096 : i64, module.device_id = 0 : i64, module.dynamic_coeff_offset = 4096 : i64, module.neuron_addr = 2199023255552 : i64, module.neuron_size = 12288 : i64, module.step = 0 : i64} {
    func.func @main(%arg0: tensor<32x16xf32> loc(unknown), %arg1: tensor<16x34xf32> loc(unknown)) -> tensor<32x34xf32, 2199023259648 : i64> {
      %0 = "top.Input"(%arg1) {do_preprocess = false} : (tensor<16x34xf32>) -> tensor<16x34xf32, 2199023255552 : i64> loc(#loc1)
      %1 = call @subfunc_0(%0) : (tensor<16x34xf32, 2199023255552 : i64>) -> tensor<32x34xf32, 2199023259648 : i64> loc(#loc)
      return %1 : tensor<32x34xf32, 2199023259648 : i64> loc(#loc)
    } loc(#loc)
    func.func @subfunc_0(%arg0: tensor<16x34xf32, 2199023255552 : i64> loc("y.1")) -> tensor<32x34xf32, 2199023259648 : i64> attributes {id = 0 : i64, mode = #tpu<run_mode TPU_STATIC>, next_index = array<i32: -1>} {
      %0 = "top.None"() : () -> none loc(#loc)
      %1 = "tpu.CoreParallel"(%arg0) ({
        %6:8 = "tpu.Split"(%arg0) : (tensor<16x34xf32, 2199023255552 : i64>) -> (tensor<2x34xf32, 2199023255552 : i64>, tensor<2x34xf32, 2199023255824 : i64>, tensor<2x34xf32, 2199023256096 : i64>, tensor<2x34xf32, 2199023256368 : i64>, tensor<2x34xf32, 2199023256640 : i64>, tensor<2x34xf32, 2199023256912 : i64>, tensor<2x34xf32, 2199023257184 : i64>, tensor<2x34xf32, 2199023257456 : i64>) loc(#loc3)
        %7 = "tpu.Cast"(%6#0) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<2x34xf32, 2199023255552 : i64>) -> tensor<2x34xf16, 33438467887104 : i64> loc(#loc4)
        %8 = "tpu.Cast"(%6#1) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<2x34xf32, 2199023255824 : i64>) -> tensor<2x34xf16, 33438467887240 : i64> loc(#loc5)
        %9 = "tpu.Cast"(%6#2) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<2x34xf32, 2199023256096 : i64>) -> tensor<2x34xf16, 33438467887376 : i64> loc(#loc6)
        %10 = "tpu.Cast"(%6#3) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<2x34xf32, 2199023256368 : i64>) -> tensor<2x34xf16, 33438467887512 : i64> loc(#loc7)
        %11 = "tpu.Cast"(%6#4) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<2x34xf32, 2199023256640 : i64>) -> tensor<2x34xf16, 33438467887648 : i64> loc(#loc8)
        %12 = "tpu.Cast"(%6#5) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<2x34xf32, 2199023256912 : i64>) -> tensor<2x34xf16, 33438467887784 : i64> loc(#loc9)
        %13 = "tpu.Cast"(%6#6) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<2x34xf32, 2199023257184 : i64>) -> tensor<2x34xf16, 33438467887920 : i64> loc(#loc10)
        %14 = "tpu.Cast"(%6#7) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<2x34xf32, 2199023257456 : i64>) -> tensor<2x34xf16, 33438467888056 : i64> loc(#loc11)
        %15 = "tpu.Join"(%7, %8, %9, %10, %11, %12, %13, %14) : (tensor<2x34xf16, 33438467887104 : i64>, tensor<2x34xf16, 33438467887240 : i64>, tensor<2x34xf16, 33438467887376 : i64>, tensor<2x34xf16, 33438467887512 : i64>, tensor<2x34xf16, 33438467887648 : i64>, tensor<2x34xf16, 33438467887784 : i64>, tensor<2x34xf16, 33438467887920 : i64>, tensor<2x34xf16, 33438467888056 : i64>) -> tensor<16x34xf16, 33438467887104 : i64> loc(#loc2)
        "tpu.Yield"(%15) : (tensor<16x34xf16, 33438467887104 : i64>) -> () loc(#loc2)
      }) {offset = 0 : i64, size = 8 : i64} : (tensor<16x34xf32, 2199023255552 : i64>) -> tensor<16x34xf16, 33438467887104 : i64> loc(#loc2)
      %2 = "top.Weight"() : () -> tensor<32x16xf16, 1099511627776 : i64> loc(#loc12)
      %3 = "tpu.Buffer"() {buffer_type = #tpu<buffer_type L2>} : () -> tensor<1088xi8, 33438467883008 : i64> loc(#loc13)
      %4 = "tpu.MatMul"(%2, %1, %0, %0, %3) {do_relu = false, fuse_rq = false, hdim_is_batch = false, input_zp = 0 : i64, keep_dims = true, left_reuse = 0 : i64, left_transpose = false, multipliers = [1], output_transpose = false, quant_mode = #tpu<rq_mode MultiplierShift>, relu_limit = -1.000000e+00 : f64, right_transpose = false, right_zp = 0 : i64, round_mode = #tpu<round_mode HalfAwayFromZero>, rshifts = [0]} : (tensor<32x16xf16, 1099511627776 : i64>, tensor<16x34xf16, 33438467887104 : i64>, none, none, tensor<1088xi8, 33438467883008 : i64>) -> tensor<32x34xf16, 33438467891200 : i64> loc(#loc14)
      %5 = "tpu.CoreParallel"(%4) ({
        %6:8 = "tpu.Split"(%4) : (tensor<32x34xf16, 33438467891200 : i64>) -> (tensor<4x34xf16, 33438467891200 : i64>, tensor<4x34xf16, 33438467891472 : i64>, tensor<4x34xf16, 33438467891744 : i64>, tensor<4x34xf16, 33438467892016 : i64>, tensor<4x34xf16, 33438467892288 : i64>, tensor<4x34xf16, 33438467892560 : i64>, tensor<4x34xf16, 33438467892832 : i64>, tensor<4x34xf16, 33438467893104 : i64>) loc(#loc16)
        %7 = "tpu.Cast"(%6#0) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<4x34xf16, 33438467891200 : i64>) -> tensor<4x34xf32, 2199023259648 : i64> loc(#loc17)
        %8 = "tpu.Cast"(%6#1) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<4x34xf16, 33438467891472 : i64>) -> tensor<4x34xf32, 2199023260192 : i64> loc(#loc18)
        %9 = "tpu.Cast"(%6#2) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<4x34xf16, 33438467891744 : i64>) -> tensor<4x34xf32, 2199023260736 : i64> loc(#loc19)
        %10 = "tpu.Cast"(%6#3) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<4x34xf16, 33438467892016 : i64>) -> tensor<4x34xf32, 2199023261280 : i64> loc(#loc20)
        %11 = "tpu.Cast"(%6#4) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<4x34xf16, 33438467892288 : i64>) -> tensor<4x34xf32, 2199023261824 : i64> loc(#loc21)
        %12 = "tpu.Cast"(%6#5) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<4x34xf16, 33438467892560 : i64>) -> tensor<4x34xf32, 2199023262368 : i64> loc(#loc22)
        %13 = "tpu.Cast"(%6#6) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<4x34xf16, 33438467892832 : i64>) -> tensor<4x34xf32, 2199023262912 : i64> loc(#loc23)
        %14 = "tpu.Cast"(%6#7) {round_mode = #tpu<round_mode HalfAwayFromZero>, with_scale = true} : (tensor<4x34xf16, 33438467893104 : i64>) -> tensor<4x34xf32, 2199023263456 : i64> loc(#loc24)
        %15 = "tpu.Join"(%7, %8, %9, %10, %11, %12, %13, %14) : (tensor<4x34xf32, 2199023259648 : i64>, tensor<4x34xf32, 2199023260192 : i64>, tensor<4x34xf32, 2199023260736 : i64>, tensor<4x34xf32, 2199023261280 : i64>, tensor<4x34xf32, 2199023261824 : i64>, tensor<4x34xf32, 2199023262368 : i64>, tensor<4x34xf32, 2199023262912 : i64>, tensor<4x34xf32, 2199023263456 : i64>) -> tensor<32x34xf32, 2199023259648 : i64> loc(#loc15)
        "tpu.Yield"(%15) : (tensor<32x34xf32, 2199023259648 : i64>) -> () loc(#loc15)
      }) {offset = 0 : i64, size = 8 : i64} : (tensor<32x34xf16, 33438467891200 : i64>) -> tensor<32x34xf32, 2199023259648 : i64> loc(#loc15)
      return %5 : tensor<32x34xf32, 2199023259648 : i64> loc(#loc)
    } loc(#loc)
  } loc(#loc)
} loc(#loc)
#loc2 = loc("y.14_f16")
#loc3 = loc("y.1_0")
#loc4 = loc("y.14_f16_0")
#loc5 = loc("y.14_f16_1")
#loc6 = loc("y.14_f16_2")
#loc7 = loc("y.14_f16_3")
#loc8 = loc("y.14_f16_4")
#loc9 = loc("y.14_f16_5")
#loc10 = loc("y.14_f16_6")
#loc11 = loc("y.14_f16_7")
#loc12 = loc("43_f16")
#loc13 = loc("4_buffer")
#loc14 = loc("4")
#loc15 = loc("4_f32")
#loc16 = loc("4_0")
#loc17 = loc("4_f32_0")
#loc18 = loc("4_f32_1")
#loc19 = loc("4_f32_2")
#loc20 = loc("4_f32_3")
#loc21 = loc("4_f32_4")
#loc22 = loc("4_f32_5")
#loc23 = loc("4_f32_6")
#loc24 = loc("4_f32_7")

